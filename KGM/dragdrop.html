<!DOCTYPE html> 
<html lang="en" style="width: 100%; height: 100%"> 
	<head> 
		<meta charset="utf-8" /> 
		<meta http-equiv="X-UA-Compatible" content="IE=Edge;chrome=1" /> 
		<style type="text/css"> 
		</style> 
	</head> 


<body class="center">  

<script type="text/javascript" src="pixastic.core.js"></script>
<script type="text/javascript" src="brightness.js"></script>
<script type="text/javascript" src="invert.js"></script>
<script type="text/javascript" src="blur.js"></script>



<table align="center" style="width:auto; height: auto;">
    <tr><td style="height: 700px;">
    <img id="imgBG" src="1.jpg" style="border:21px solid;"/>
    </td></tr>

<tr><td>
<img src="rotate_cw.png" onclick="RotatePlus()"/>
<img src="rotate_ccw.png" onclick="RotateMinus()"/>
<button onclick="someFilter()">Some Filter</button>

<button onclick="Blur()">Blur</button>
<button onclick="Invert()">Invert</button>
</td></tr>
</table>


<script type="text/javascript"> 
var dropbox = document.getElementById('imgBG'); 
//var ddbDiv = document.getElementById('divMain'); 

dropbox.style.height = "500px";

/*
var ddbHeight = dropbox.style.height;
var ddbWidth = dropbox.style.width;

if(ddbHeight>ddbWidth)
{
	ddbDiv.style.width=ddbHeight;
	ddbDiv.style.height=ddbHeight;
}
else
{
	ddbDiv.style.width=ddbWidth;
	ddbDiv.style.height=ddbWidth;
}
*/


// Setup drag and drop handlers. 
dropbox.addEventListener('dragenter', stopDefault, false); 
dropbox.addEventListener('dragover', stopDefault, false); 
dropbox.addEventListener('dragleave', stopDefault, false); 
dropbox.addEventListener('drop', onDrop, false); 

function stopDefault(e)  
{ 
  e.stopPropagation(); 
  e.preventDefault(); 
} 


function onDrop(e)  
{ 
e.stopPropagation(); 
e.preventDefault(); 

var readFileSize = 0; 
var files = e.dataTransfer.files; 


file = files[0]; 
readFileSize += file.fileSize; 


// Only process image files. 
var imageType = /image.*/; 

if (!file.type.match(imageType))  
{ 
return; 
} 


var reader = new FileReader(); 


reader.onerror = function(e)  
{ 
alert('Error code: ' + e.target.error); 
}; 


// Create a closure to capture the file information. 
reader.onload = (function(aFile)  
{ 
return function(evt)  
{ 
    dropbox.src = evt.target.result;
    dropbox.style.height = "500px";
} 
})(file); 

// Read in the image file as a data url. 
reader.readAsDataURL(file); 

} 
var Rad = 0;
function RotatePlus() {
	Rad+=90;
	dropbox.style.webkitTransform = "rotate(" + Rad + "deg)"; // for Chrome
	dropbox.style.MozTransform = "rotate(" + Rad + "deg)"; // for FF
}
function RotateMinus() {
	Rad-=90;
	dropbox.style.webkitTransform = "rotate(" + Rad + "deg)"; // for Chrome
	dropbox.style.MozTransform = "rotate(" + Rad + "deg)"; // for FF
}

function someFilter(){
	//document.getElementById("imgBG").style.filter ="progid:DXImageTransform.Microsoft.BasicImage(Invert=1, XRay=0)";
	
	if (dropbox.complete) {	// make sure the image is fully loaded
		var newimg = Pixastic.process(
			dropbox,
			"invert", null
		)
		dropbox=newimg;
	}
	
}

function Blur(){
	//document.getElementById("imgBG").style.filter ="progid:DXImageTransform.Microsoft.BasicImage(Invert=1, XRay=0)";
	
	if (dropbox.complete) {	// make sure the image is fully loaded
		var newimg = Pixastic.process(
			dropbox,
			"blur", null
		)
		dropbox=newimg;
	}

}

function Invert(){
	//document.getElementById("imgBG").style.filter ="progid:DXImageTransform.Microsoft.BasicImage(Invert=1, XRay=0)";
	
	if (dropbox.complete) {	// make sure the image is fully loaded
		var newimg = Pixastic.process(
			dropbox,
			"invert", null
		)
		dropbox=newimg;
	}
	
}


</script>


</body> 
</html>